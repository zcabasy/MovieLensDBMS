<!doctype html>
<html lang="en" class="h-100">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="">
  
  <meta name="generator" content="Hugo 0.88.1">
  <title>MovieLens</title>

  <link rel="canonical" href="https://getbootstrap.com/docs/5.1/examples/cover/">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
    integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">

  <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
    integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
    crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
    integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
    crossorigin="anonymous"></script>


  <!-- Bootstrap core CSS -->
  <link href="../assets/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://kit.fontawesome.com/62896aab70.js" crossorigin="anonymous"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
  <script src="/static/assets/js/setting-demo2.js"></script>


  <!-- Custom styles for this template -->
  <link href="../static/cover.css" rel="stylesheet">
</head>

<body class="d-flex h-100 text-center text-white bg-dark">

  <div class="d-flex w-100 h-100 p-3 mx-auto flex-column">
    <header class="mb-auto">
      <div>
        <h3 class="float-md-start mb-0">Team 1</h3>
        <nav class="nav nav-masthead justify-content-center float-md-end">
          <a class="nav-link" href="./use-case-1.html">Case 1</a>
          <a class="nav-link" href="./use-case-2.html">Case 2</a>
          <a class="nav-link active" aria-current="page" href="./use-case-3.html">Case 3</a>
          <a class="nav-link" href="./use-case-4.html">Case 4</a>
          <a class="nav-link" href="./use-case-5.html">Case 5</a>
          <a class="nav-link" href="./use-case-6.html">Case 6</a>



        </nav>
      </div>
    </header>

    <h1>Case 3</h1>

    <h4>Showing the {{ popular_genres|length }} most popular and {{ polarising_genres|length }} most polarising genres</h4>
    <div class='row'>
      <div class='col'>

        <h3>Popular Movies</h3>

        <table class="table table-bordered table-striped table-dark">
          <thead>
            <tr>
              <th>Genre</th>
              <th>Mean Rating</th>
              <th>Std Dev of Ratings</th>
              <th>Lowest Rating</th>
              <th>Highest Rating</th>
              <th>Number of Ratings</th>
            </tr>
          </thead>
          <tbody id="popularMovies">
            {% for genre in popular_genres %}
            <tr>
              <td>{{ genre.genre }}</td>
              <td>{{ genre.rating|round(3) }}</td>
              <td>{{ genre.std_rating|round(3) }}</td>
              <td>{{ genre.min_rating }}</td>
              <td>{{ genre.max_rating }}</td>
              <td>{{ genre.num_ratings }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
          <div class="card" style="text-align: center;">
            <div class="card-header">
              <div class="card-title">Popular Movie Statistics</div>
            </div>
            <div class="card-body">
              <div class="chart-container">
                <canvas id="popChart"></canvas>
              </div>
            </div>
          </div>

      </div>

      <div class='col'>
        <h3>Polarising movies</h3>


        <table class="table table-bordered table-striped table-dark">
          <thead>
            <tr>
              <th>Genre</th>
              <th>Mean Rating</th>
              <th>Std Dev of Ratings</th>
              <th>Lowest Rating</th>
              <th>Highest Rating</th>
              <th>Range of Ratings</th>
              <th>Number of Ratings</th>
            </tr>
          </thead>
          <tbody id="polarisingMovies">
            {% for genre in polarising_genres %}
            <tr>
              <td>{{ genre.genre }}</td>
              <td>{{ genre.rating|round(3) }}</td>
              <td>{{ genre.std_rating|round(3) }}</td>
              <td>{{ genre.min_rating }}</td>
              <td>{{ genre.max_rating }}</td>
              <td>{{ genre.range_rating }}</td>
              <td>{{ genre.num_ratings }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>

        <div class="card" style="text-align: center;">
          <div class="card-header">
            <div class="card-title">Polarising Movie Statistics</div>
          </div>
          <div class="card-body">
            <div class="chart-container">
              <canvas id="polChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>


    <form action="#" method="post">


      <div class="form-group row">
        <div class="col-sm-10">
        </div>
      </div>
      
      </div>
    </form>





    <footer class="mt-auto text-white-50">
    </footer>
  </div>

  {% extends "layouts/base.html" %}

  {% block title %} Case 3 {% endblock %}

  <!-- Specific Page CSS goes HERE  -->
  {% block stylesheets %}{% endblock stylesheets %}

  {% block content %}


</body>

{% endblock content %}
<!-- Specific Page JS goes HERE  -->
{% block javascripts %}

<script>
  let filename = 'https://raw.githubusercontent.com/zcabasy/MovieLensDBMS/main/webapp/data/ratings.csv';

  let popData = {{ popular_genres | safe }};
  let polData = {{ polarising_genres | safe }};

  popData = JSON.parse(JSON.stringify(popData));
  polData = JSON.parse(JSON.stringify(polData));
  var polGenre = [];
  var polRating = [];
  var polSDeviation = [];
  var polVotes = [];

  var popGenre = [];
  var popRating = [];
  var popSDeviation = [];
  var popVotes = [];
  for(var i=0; i < polData.length; i++) {
    polGenre.push(polData[i].genre);
    polRating.push(polData[i].rating);
    polSDeviation.push(polData[i].std_rating);
    polVotes.push(polData[i].num_ratings/10000)
  }
   for (var i = 0; i < popData.length; i++) {
      popGenre.push(popData[i].genre);
      popRating.push(popData[i].rating);
      popSDeviation.push(popData[i].std_rating);
      popVotes.push(popData[i].num_ratings/10000)
    }

  
  d3.csv(filename)
    .then(makeChart);


  function makeChart(data) {

    var movieId = data.map(function (d) { return d.movieId });
    var rating = data.map(function (d) { return d.rating; });

    var popChart = document.getElementById('popChart').getContext('2d'),
    polChart = document.getElementById('polChart').getContext('2d');

    var myPopChart = new Chart(popChart, {
      type: 'horizontalBar',
      data: {
        labels: popGenre,
        datasets: [{
          label: 'Mean Rating',
          data: popRating,
          // data: [18, 12, 6, 9, 12, 3, 9],
          backgroundColor:
            'rgba(255, 26, 104, 0.2)',
          borderColor:
            'rgba(255, 26, 104, 1)',
          borderWidth: 1
        },
        {
          label: 'Standard Deviation',
          data: popSDeviation,
          // data: [18, 12, 6, 9, 12, 3, 9],
          backgroundColor:
            'rgba(54, 162, 235, 0.2)',
          borderColor:
            'rgba(54, 162, 235, 1)',
          borderWidth: 1
        },
        {
          label: 'Number of Votes (per 10000)',
            data: popVotes,
            // data: [18, 12, 6, 9, 12, 3, 9],
            backgroundColor:
              'rgba(153, 102, 255, 0.2)',
            borderColor:
              'rgba(153, 102, 255, 1)',
            borderWidth: 1
          },
         
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        },
        
        // Elements options apply to all of the options unless overridden in a dataset
        // In this case, we are setting the border of each horizontal bar to be 2px wide
        elements: {
          bar: {
            borderWidth: 2,
          }
        },
        responsive: true,
        plugins: {
          legend: {
            position: 'right',
          },
          title: {
            display: true,
            text: 'Chart.js Horizontal Bar Chart'
          }
        }
      }
    });

     var myPolChart = new Chart(polChart, {
        type: 'horizontalBar',
        data: {
          labels: polGenre,
          datasets: [{
            label: 'Mean Rating',
            // data: popRating,
            data: polRating,
            backgroundColor:
              'rgba(255, 26, 104, 0.2)',
            borderColor:
              'rgba(255, 26, 104, 1)',
            borderWidth: 1
          },
          {
            label: 'Standard Deviation',
            // data: polRating,
            data: polSDeviation,
            backgroundColor:
              'rgba(54, 162, 235, 0.2)',
            borderColor:
              'rgba(54, 162, 235, 1)',
            borderWidth: 1
          },
          {
            label: 'Number of Votes (per 10000)',
            // data: polRating,
            data: polVotes,
            backgroundColor:
              'rgba(153, 102, 255, 0.2)',
            borderColor:
              'rgba(153, 102, 255, 1)',
            borderWidth: 1
          },

          ],
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            yAxes: [{
              ticks: {
                beginAtZero: true
              }
            }]
          },

          // Elements options apply to all of the options unless overridden in a dataset
          // In this case, we are setting the border of each horizontal bar to be 2px wide
          elements: {
            bar: {
              borderWidth: 2,
            }
          },
          responsive: true,
          plugins: {
            legend: {
              position: 'right',
            },
            title: {
              display: true,
              text: 'Chart.js Horizontal Bar Chart'
            }
          }
        }
      });
  }
</script>

{% endblock javascripts %}

</html>